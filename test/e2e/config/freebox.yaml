managementClusterName: freebox-test

images:
- name: example.com/cluster-api-provider-freebox:v0.0.1
  loadBehavior: mustLoad

providers:
- name: cluster-api
  type: CoreProvider
  versions:
  - name: v1.11.1
    value: https://github.com/kubernetes-sigs/cluster-api/releases/download/v1.11.1/core-components.yaml
    type: "url"
    replacements:
    - old: "imagePullPolicy: Always"
      new: "imagePullPolicy: IfNotPresent"
    files:
    - sourcePath: "../data/shared/v1beta1/metadata.yaml"

- name: kubeadm
  type: BootstrapProvider
  versions:
  - name: v1.11.1
    value: https://github.com/kubernetes-sigs/cluster-api/releases/download/v1.11.1/bootstrap-components.yaml
    type: "url"
    replacements:
    - old: "imagePullPolicy: Always"
      new: "imagePullPolicy: IfNotPresent"
    files:
    - sourcePath: "../data/shared/v1beta1/metadata.yaml"

- name: kubeadm
  type: ControlPlaneProvider
  versions:
  - name: v1.11.1
    value: https://github.com/kubernetes-sigs/cluster-api/releases/download/v1.11.1/control-plane-components.yaml
    type: "url"
    replacements:
    - old: "imagePullPolicy: Always"
      new: "imagePullPolicy: IfNotPresent"
    files:
    - sourcePath: "../data/shared/v1beta1/metadata.yaml"

- name: freebox
  type: InfrastructureProvider
  versions:
  - name: v0.0.1
    value: ../../../config/default
    replacements:
    - old: "imagePullPolicy: Always"
      new: "imagePullPolicy: IfNotPresent"
    - old: controller:latest
      new: example.com/cluster-api-provider-freebox:v0.0.1
    files:
    - sourcePath: "../data/infrastructure-freebox/cluster-template.yaml"

variables:
  KUBERNETES_VERSION: "v1.31.0"
  CNI: "./data/cni/kindnet/kindnet.yaml"
  EXP_CLUSTER_RESOURCE_SET: "true"
  CLUSTER_TOPOLOGY: "true"
  IP_FAMILY: "IPv4"
  FREEBOX_ENDPOINT: "${FREEBOX_ENDPOINT:-http://freebox-mock.local}"
  FREEBOX_APP_ID: "${FREEBOX_APP_ID:-cluster-api-provider-freebox}"
  FREEBOX_TOKEN: "${FREEBOX_TOKEN:-mock-token}"
  FREEBOX_VERSION: "${FREEBOX_VERSION:-v4}"

intervals:
  default/wait-controllers: ["3m", "10s"]
  default/wait-cluster: ["5m", "10s"]
  default/wait-control-plane: ["10m", "10s"]
  default/wait-worker-nodes: ["5m", "10s"]
  default/wait-delete-cluster: ["3m", "10s"]
  default/wait-machine-upgrade: ["20m", "10s"]
  default/wait-machine-remediation: ["5m", "10s"]
  default/wait-deployment: ["5m", "10s"]
  default/wait-job: ["5m", "10s"]
  default/wait-service: ["3m", "10s"]
